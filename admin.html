<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon">

  <title>Admin Portal</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Lalezar&display=swap&family=Staatliches&display=swap&family=Bebas+Neue&display=swap&family=Courgette&display=swap&family=Kavoon&display=swap&family=Seaweed+Script&display=swap&family=Yesteryear&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Clicker+Script&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Marck+Script&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css"
    integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
  <link rel="stylesheet" href="plugin/css/bootstrap.min.css">
  <link rel="stylesheet" href="plugin/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="plugin/css/custom.css">
  <script src="plugin/js/jquery-3.5.1.min.js"></script>
  <script src="plugin/js/bootstrap.bundle.min.js"></script>
  <script src="plugin/js/custom.js"></script>
  <script src="plugin/js/typed.js"></script>
  <script src="plugin/js/jquery.easing.min.js"></script>
</head>

<body>
  <section id="backend">
    <div class="container">
      <div class="row bg-box ">
        <div class="col-12 d-flex justify-content-end" style="height: 5%;">
          <a href="api/logout.php">
            <div class="to-home mx-3" >Logout</div>
          </a>
          <a href="index.html">
            <div class="to-home">Home</div>
          </a>
        </div>
        <div id="adminMenu" class="col-12 row justify-content-center" style="height: 6%;">
          <!-- nav -->
          <ul class="nav nav-tabs col-11 d-flex justify-content-around">
            <li class="nav-item">
              <a class="nav-link" onclick="toShow(1)">Personal Info</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="toShow(2)">Introduction</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="toShow(3)">Experience</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" >Skill</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" >Portfolio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" >Album</a>
            </li>
          </ul>
        </div>
        <!-- content -->
        <div id="backContent" class="col-md-12 content-box overflow-auto">


<!-- Intro -->
          <form id="intro" class="col-12 row my-3 mx-0">
            <div class="con w-100">
            </div>
            <div class="w-100">
              <div class="input-group col-12 my-2">
                <div class="input-group-prepend">
                  <span class="input-group-text">Introduction_CH</span>
                </div>
                <textarea style="height:5rem;" class="form-control" name="intro_CH" title=""></textarea>
              </div>
              <div class="input-group col-12 my-2">
                <div class="input-group-prepend">
                  <span class="input-group-text">Introduction_EN</span>
                </div>
                <textarea style="height:5rem;" class="form-control" name="intro" title=""></textarea>
              </div>
              <div class="input-group col-12 mt-5">
                <input type="submit" class="form-control" value="Edit / Add">
              </div>
            </div>
          </form>


<!-- persoanl info + contact -->
          <form id="per" class="col-12 row my-3 mx-0">
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Name</div>
              </div>
              <input type="text" class="form-control" name="name" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Name_CH</div>
              </div>
              <input type="text" class="form-control" name="name_CH" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Bidthday</div>
              </div>
              <input type="date" class="form-control" name="birth" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Location</div>
              </div>
              <input type="text" class="form-control" name="location" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Telphone</div>
              </div>
              <input type="text" class="form-control" name="tel" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Email</div>
              </div>
              <input type="text" class="form-control" name="email" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">LinkedIn</div>
              </div>
              <input type="text" class="form-control" name="linkedin" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">Codepen</div>
              </div>
              <input type="text" class="form-control" name="codepen" placeholder="">
            </div>
            <div class="input-group col-6 my-2">
              <div class="input-group-prepend">
                <div class="input-group-text">github</div>
              </div>
              <input type="text" class="form-control" name="github" placeholder="">
            </div>


            <!-- <select class="custom-select">
              <option value="0">Hide</option>
              <option value="1">Show</option>
            </select> -->


            <div class="input-group col-12 mt-5">
              <input type="submit" class="form-control" value="Edit">
            </div>
          </form>

<!-- persoanl info + contact -->
          <form id="exp" class="col-12 row my-1 mx-0">
            <div class="exp-box-1 col-12 row">
              <h4 class="text-danger col-12 text-center">Company</h4>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Company</div>
                </div>
                <input type="text" class="form-control" name="company">
              </div>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Company_CH</div>
                </div>
                <input type="text" class="form-control" name="company_CH">
              </div>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Title</div>
                </div>
                <input type="text" class="form-control" name="title">
              </div>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Title_CH</div>
                </div>
                <input type="text" class="form-control" name="title_CH">
              </div>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Period</div>
                </div>
                <input type="text" class="form-control" name="period">
              </div>
              <div class="input-group col-6 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Show or Hide</div>
                </div>
                <select class="custom-select" id="">
                  <option value="1">Show</option>
                  <option value="0">Hide</option>
                </select>
              </div>
            </div>
            <div class="exp-box-2 col-12 mt-3 row">
              <h4 class="text-danger col-12 text-center">Job Description</h4>
              <div class="input-group col-12 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Description_EN</div>
                </div>
                <input type="text" class="form-control" name="description">
              </div>
              <div class="input-group col-12 mt-1">
                <div class="input-group-prepend">
                  <div class="input-group-text">Description_CH</div>
                </div>
                <input type="text" class="form-control" name="description_CH">
              </div>
            </div>
            <!-- <div class="exp-box-3 col-12 mt-3 row">
              <h4 class="text-danger col-12 text-center">Project Achieved</h4>
            </div>
            <div class="input-group col-12 mt-5"> 
              <input type="submit" class="form-control" value="Edit">

            </div> -->
          </form>

        </div>
      </div>
    </div>
  </section>
  <script>
    
    function initial(){
      $("#intro").hide();
      $("#per").hide();
      $("#exp").hide();
      
    }

    initial()

    function toShow(tab){
      initial()
      switch (tab){
        case 1:
          $("#per").show()
        break;
        case 2:
          $("#intro").show()
        break;
        case 3:
          $("#exp").show()
        break;
      }
    }

    getJSON('api/per.php') // load personal info
    .then((re) => {
      re.contact.forEach((e) => {  // contact
        $(`input[name=${e.name}]`).val(e.value)
      })
      re.intro.forEach((e, idx) => { // intro
        let T = "";
        if (e.name == "intro"){T = "Introduction_EN";}
        if (e.name == "intro_CH"){T = "Introduction_CH";}
        $("#intro .con").append(
          `<div class="input-group col-12 my-2"><div class='input-group-prepend'><span class='input-group-text'>${T}</span></div><textarea style="height:5rem;" class='form-control' name='${e.name}' title='${e.id}'>${e.value}</textarea>`
        )
      })
      Object.keys(re.per[0]).forEach((e, idx) => { // personal info
        $(`input[name=${e}]`).val(re.per[0][e])
      })
    })

    getJSON('api/exp.php') // load experience
    .then((re)=>{
      re[0].forEach(e => {
        $("#experience .ex-row").append(`<div class='comN-${e.id} col-12 col-md-9 col-xl-8 row justify-content-center' data-toggle='collapse' href='#comN-${e.id}'><div class='col-10'><div class='exp-1'><i class='icon-flag'></i> ${e.period} ${e.company} ${e.company_CH}</div><div class='exp-2'>${e.title}</div><div class='exp-3'></div></div><div class='col-1'><img src='image/milestone-c.png' height='180px'></div></div><div class='collapse col-12 col-md-9 col-xl-8 pt-2 pb-5' id='comN-${e.id}'><div class='com-des-${e.id} p-2 card card-body'></div></div>`)
      });
      re[1].forEach(e => {
        $(`.com-des-${e.company}`).append(`<div class='exp-4'>${e.period} ${e.project_name_CH}</div><div class='exp-5'>${e.description_CH}</div>`)
      })
      re[2].forEach(e=>{
        $(`.comN-${e.company} .exp-3`).append(`<div class='p-0'>☆ ${e.description_CH}<div>`)
      })
    })



    $('form#intro').on('submit', function(){
      console.log(1)
      let table="intro"
      let a=[]
      $("#intro textarea").each((e)=>{
        a[e]={
          'name':$("#intro textarea")[e].attributes.name.nodeValue,
          'value':$("#intro textarea")[e].innerHTML,
          'id':$("#intro textarea")[e].attributes.title.nodeValue}
      })
        console.log(a)
    $.ajax({
        url: 'api/test.php',              // 要傳送的頁面
        method: 'POST',               // 使用 POST 方法傳送請求
        dataType: 'string',             // 回傳資料會是 json 格式
        data: a.serialize(),  // 將表單資料用打包起來送出去
        success: function(res){ // 成功以後會執行這個方法
          console.log(res)
        },
    });
    return false;  // 阻止瀏覽器跳轉到 send.php，因為已經用 ajax 送出去了
});

    // $("#intro").submit(function(){
    //   let table="intro"
    //   let a=[]
    //   $("#intro textarea").each((e)=>{
    //     // console.log($("#intro textarea")[e].attributes.name.nodeValue) // name
    //     // console.log($("#intro textarea")[e].innerHTML) // value
    //     a[e]={
    //       'name':$("#intro textarea")[e].attributes.name.nodeValue,
    //       'value':$("#intro textarea")[e].innerHTML,
    //       'id':$("#intro textarea")[e].attributes.title.nodeValue}
    //   })
      
    //   data=a
    //     console.log(data)
    //   $.post("api/test.php", {data,table}, function (re) {
    //     console.log(re)
    //     })

      
    // })
  </script>
</body>

</html>